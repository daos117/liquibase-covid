library(tidyverse)
url_covid <- 'https://datos.covid-19.conacyt.mx/Downloads/Files/Casos_Diarios_Estado_Nacional_Confirmados_20211006.csv'
data <- read.csv(url_covid, header = TRUE)
data <- data %>%
select(-cve_ent, -poblacion) %>%
pivot_longer(!nombre, names_to = "fecha", values_to = "confirmados") %>%
pivot_wider(names_from = nombre, values_from = confirmados) %>%
mutate(fecha = gsub("X", "", fecha)) %>%
mutate(fecha = as.Date(fecha, "%d.%m.%Y"))
if (any(is.na(data)) == TRUE) {data = na.omit(data)}  # TRUE = hay al menos un valor NA
# correrlo una vez para guardarlo, despues comentar la funci√≥n
write.csv(data,
file = 'C:/Users/David/OneDrive/Documentos/DAOS curses/Datalab SDC4/demo 1/liquibase-covid/code daos/confirmados.csv',
row.names = F)
library(tidymodels)
library(modeltime)
library(timetk)
library(lubridate)
library(tidyverse)
library(lubridate)
dat <- read.csv("C:/Users/David/OneDrive/Documentos/DAOS curses/Datalab SDC4/demo 1/liquibase-covid/code daos/confirmados.csv", header = TRUE)
ts.agu <- ts(data[2],     # random data
start = c(2020, as.numeric(format(data$fecha[1], "%j"))),
frequency = 365)
data <- read.csv("C:/Users/David/OneDrive/Documentos/DAOS curses/Datalab SDC4/demo 1/liquibase-covid/code daos/confirmados.csv", header = TRUE)
ts.agu <- ts(data[2],     # random data
start = c(2020, as.numeric(format(data$fecha[1], "%j"))),
frequency = 365)
data[2]
data
library(tidymodels) #install.packages("tidymodels")
library(modeltime)  #install.packages("modeltime")
library(timetk)     #install.packages("timetk")
library(lubridate)  #install.packages("lubridate")
library(tidyverse)  #install.packages("tidyverse")
library(lubridate)  #install.packages("lubridate")
data <- read.csv("C:/Users/David/OneDrive/Documentos/DAOS curses/Datalab SDC4/demo 1/liquibase-covid/code daos/confirmados.csv", header = TRUE)
data
str(data)
as.Date(data$fecha)
data <- data %>%
mutate(fecha = as.Date(fecha))
ts.agu <- ts(data[2],
start = c(2020, as.numeric(format(data$fecha[1], "%j"))),
frequency = 365)
timetk::tk_tbl(ts.agu)
data
str(data)
format(data$fecha[1], "%j")
ts.agu <- ts(data[2],
start = c(2020, as.numeric(format(data$fecha[1], "%j"))),
frequency = 365)
ts.agu
ts.agu.tbl <- timetk::tk_tbl(ts.agu) %>%
set_names(c("date", "value")) %>%
mutate(date = date_decimal(as.numeric(time(ts.agu))))
timetk::tk_tbl(ts.agu)
plot(ts.agu)
ts.agu %>%
select(1, 2)
data %>%
select(1, 2)
ts.agu.tbl <- data %>%
select(1, 2) # select(fecha, AGUASCALIENTES)
ts.agu.tbl
ts.agu.tbl <- data %>%
select(1, 2) %>%  # select(fecha, AGUASCALIENTES)
set_names(c("date", "confirmados"))
ts.agu.tbl
ts.agu.tbl %>%
plot_time_series(date, confirmados, .interactive = F)
splits <- ts.agu.tbl %>%
time_series_split(assess = "2 months", cumulative = TRUE)
splits %>%
tk_time_series_cv_plan() %>%
plot_time_series_cv_plan(date, confirmados, .interactive = FALSE)
model_fit_arima <- arima_reg() %>%
set_engine("auto_arima") %>%
fit(confirmados ~ date, training(splits))
model_fit_arima
model_fit_prophet <- prophet_reg(seasonality_yearly = TRUE) %>%
set_engine("prophet") %>%
fit(confirmados ~ date, training(splits))
model_fit_prophet
model_fit_prophet <- prophet_reg(seasonality_yearly = TRUE) %>%
set_engine("prophet") %>%
fit(confirmados ~ date, training(splits))
library(tidymodels) #install.packages("tidymodels")
library(modeltime)  #install.packages("modeltime")
library(timetk)     #install.packages("timetk")
library(lubridate)  #install.packages("lubridate")
library(tidyverse)  #install.packages("tidyverse")
library(lubridate)  #install.packages("lubridate")
data <- read.csv("C:/Users/David/OneDrive/Documentos/DAOS curses/Datalab SDC4/demo 1/liquibase-covid/code daos/confirmados.csv", header = TRUE)
data <- data %>%
mutate(fecha = as.Date(fecha))
ts.agu <- ts(data[2],
start = c(2020, as.numeric(format(data$fecha[1], "%j"))),
frequency = 365)
ts.agu.tbl <- data %>%
select(1, 2) %>%  # select(fecha, AGUASCALIENTES)
set_names(c("date", "confirmados"))
ts.agu.tbl
ts.agu.tbl %>%
plot_time_series(date, confirmados, .interactive = F)
splits <- ts.agu.tbl %>%
time_series_split(assess = "2 months", cumulative = TRUE)
splits %>%
tk_time_series_cv_plan() %>%
plot_time_series_cv_plan(date, confirmados, .interactive = FALSE)
model_fit_arima <- arima_reg() %>%
set_engine("auto_arima") %>%
fit(confirmados ~ date, training(splits))
model_fit_arima
model_fit_prophet <- prophet_reg(seasonality_yearly = TRUE) %>%
set_engine("prophet") %>%
fit(confirmados ~ date, training(splits))
model_fit_prophet <- prophet_reg(daily.seasonality = TRUE) %>%
set_engine("prophet") %>%
fit(confirmados ~ date, training(splits))
model_fit_prophet <- prophet_reg(seasonality_daily = TRUE) %>%
set_engine("prophet") %>%
fit(confirmados ~ date, training(splits))
library(tidymodels) #install.packages("tidymodels")
library(modeltime)  #install.packages("modeltime")
library(timetk)     #install.packages("timetk")
library(lubridate)  #install.packages("lubridate")
library(tidyverse)  #install.packages("tidyverse")
library(lubridate)  #install.packages("lubridate")
data <- read.csv("C:/Users/David/OneDrive/Documentos/DAOS curses/Datalab SDC4/demo 1/liquibase-covid/code daos/confirmados.csv", header = TRUE)
data <- data %>%
mutate(fecha = as.Date(fecha))
ts.agu <- ts(data[2],
start = c(2020, as.numeric(format(data$fecha[1], "%j"))),
frequency = 365)
ts.agu.tbl <- data %>%
select(1, 2) %>%  # select(fecha, AGUASCALIENTES)
set_names(c("date", "confirmados"))
ts.agu.tbl
head(ts.agu.tbl)
ts.agu.tbl %>%
plot_time_series(date, confirmados, .interactive = F)
splits <- ts.agu.tbl %>%
time_series_split(assess = "2 months", cumulative = TRUE)
splits %>%
tk_time_series_cv_plan() %>%
plot_time_series_cv_plan(date, confirmados, .interactive = FALSE)
splits <- ts.agu.tbl %>%
time_series_split(assess = "3 months", cumulative = TRUE)
splits %>%
tk_time_series_cv_plan() %>%
plot_time_series_cv_plan(date, confirmados, .interactive = FALSE)
splits %>%
tk_time_series_cv_plan() %>%
plot_time_series_cv_plan(date, confirmados, .interactive = FALSE)
model_fit_arima <- arima_reg() %>%
set_engine("auto_arima") %>%
fit(confirmados ~ date, training(splits))
model_fit_arima
model_fit_prophet <- prophet_reg(seasonality_daily = TRUE) %>%
set_engine("prophet") %>%
fit(confirmados ~ date, training(splits))
.rs.restartR()
install.packages("modeltime", dependencies = TRUE)
install.packages("modeltime", dependencies = TRUE)
.rs.restartR()
library(tidymodels) #install.packages("tidymodels")
library(modeltime)  #install.packages("modeltime")
library(timetk)     #install.packages("timetk")
library(lubridate)  #install.packages("lubridate")
library(tidyverse)  #install.packages("tidyverse")
library(lubridate)  #install.packages("lubridate")
data <- read.csv("C:/Users/David/OneDrive/Documentos/DAOS curses/Datalab SDC4/demo 1/liquibase-covid/code daos/confirmados.csv", header = TRUE)
data <- data %>%
mutate(fecha = as.Date(fecha))
ts.agu <- ts(data[2],
start = c(2020, as.numeric(format(data$fecha[1], "%j"))),
frequency = 365)
ts.agu.tbl <- data %>%
select(1, 2) %>%  # select(fecha, AGUASCALIENTES)
set_names(c("date", "confirmados"))
head(ts.agu.tbl)
ts.agu.tbl %>%
plot_time_series(date, confirmados, .interactive = F)
splits <- ts.agu.tbl %>%
time_series_split(assess = "3 months", cumulative = TRUE)
splits %>%
tk_time_series_cv_plan() %>%
plot_time_series_cv_plan(date, confirmados, .interactive = FALSE)
model_fit_arima <- arima_reg() %>%
set_engine("auto_arima") %>%
fit(confirmados ~ date, training(splits))
model_fit_arima
model_fit_prophet <- prophet_reg(seasonality_daily = TRUE) %>%
set_engine("prophet") %>%
fit(confirmados ~ date, training(splits))
